---
import { Icon } from "astro-icon/components";
import { type NavBarLink } from "../../types/config";
import { url } from "../../utils/url-utils";

interface Props {
  links: NavBarLink[];
}

const { links } = Astro.props;
---

<div 
  id="nav-menu-panel"
  class:list={[
    "float-panel float-panel-closed",
    "absolute fixed right-4 px-2 py-2",
    "transition-all duration-300 ease-out-expo"
  ]}
  aria-label="导航菜单"
>
  {links.map((link) => (
    <a
      href={link.external ? link.url : url(link.url)}
      class="group flex justify-between items-center py-2 pl-3 pr-1 rounded-lg gap-8
             transition-all duration-200 ease-out
             hover:bg-[var(--btn-plain-bg-hover)] 
             active:bg-[var(--btn-plain-bg-active)] 
             focus:ring-2 focus:ring-[var(--primary)] focus:ring-opacity-50"
      target={link.external ? "_blank" : null}
      rel={link.external ? "noopener noreferrer" : null}
      aria-label={`访问${link.name}${link.external ? "（外部链接）" : ""}`}
    >
      <div class="transition-all duration-200 ease-out 
                 text-black/75 dark:text-white/75 font-bold 
                 group-hover:text-[var(--primary)] group-active:text-[var(--primary)]
                 group-hover:translate-x-1">
        {link.name}
      </div>
      
      {!link.external ? (
        <Icon 
          name="material-symbols:chevron-right-rounded"
          class="transition-all duration-300 ease-out-expo 
                 text-[1.25rem] text-[var(--primary)]
                 group-hover:scale-110 group-hover:translate-x-1"
          aria-hidden="true"
        />
      ) : (
        <Icon 
          name="fa6-solid:arrow-up-right-from-square"
          class="transition-all duration-300 ease-out-expo 
                 text-[0.75rem] text-black/25 dark:text-white/25
                 group-hover:text-[var(--primary)] group-hover:scale-110"
          aria-hidden="true"
        />
      )}
    </a>
  ))}
</div>

<style>
  /* 添加更流畅的动画曲线 */
  :root {
    --ease-out-expo: cubic-bezier(0.19, 1, 0.22, 1);
  }
  
  /* 面板动画效果 */
  .float-panel {
    opacity: 0;
    transform: translateX(20px);
    visibility: hidden;
    transition: 
      opacity 0.4s var(--ease-out-expo),
      transform 0.4s var(--ease-out-expo),
      visibility 0s 0.4s;
  }
  
  .float-panel:not(.float-panel-closed) {
    opacity: 1;
    transform: translateX(0);
    visibility: visible;
    transition: 
      opacity 0.4s var(--ease-out-expo),
      transform 0.4s var(--ease-out-expo),
      visibility 0s;
  }
  
  /* 菜单项悬停动画 */
  a {
    transform-origin: center;
    transition: 
      background-color 0.2s ease,
      transform 0.3s var(--ease-out-expo);
  }
  
  a:hover {
    transform: scale(1.02);
  }
  
  a:active {
    transform: scale(0.98);
  }
</style>
